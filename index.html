<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"> <!-- Определяет кодировку документа (UTF-8) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Позволяет адаптировать страницу к размерам экрана устройства -->

    <script src="https://telegram.org/js/telegram-web-app.js"></script> <!-- Подключение скрипта для работы с Telegram Web App -->

    <title>Telegram Web App</title> <!-- Заголовок страницы -->
    
    <style>
        /* CSS для задания стилей элементов страницы */
        .loading-screen {
            display: flex; /* Используем флексбокс для центрирования содержимого */
            flex-direction: column; /* Раскладываем дочерние элементы по вертикали */
            align-items: center; /* Центрирование по горизонтали */
            justify-content: center; /* Центрирование по вертикали */
            height: 100vh; /* Высота экрана 100% */
            background: #f0f0f0; /* Фоновый цвет экрана */
        }
        .nav-buttons {
            display: flex; /* Используем флексбокс для горизонтального расположения кнопок */
            justify-content: space-around; /* Равномерное распределение кнопок с отступом */
            margin-top: 20px; /* Отступ сверху для нижней панели кнопок */
        }
        .nav-button {
            cursor: pointer; /* Указатель мыши меняется на курсор указателя при наведении */
            text-align: center; /* Центрирование текста внутри кнопки */
        }
        .modal {
            display: none; /* Скрыть модальное окно по умолчанию */
            position: fixed; /* Фиксированное позиционирование для модального окна */
            z-index: 1; /* Обеспечивает, что модальное окно будет выше других элементов */
            left: 0; /* Позиционирование слева */
            top: 0; /* Позиционирование сверху */
            width: 100%; /* Ширина на весь экран */
            height: 100%; /* Высота на весь экран */
            background-color: rgb(0, 0, 0); /* Чёрный фон */
            background-color: rgba(0, 0, 0, 0.4); /* Полупрозрачный фон */
        }
        .modal-content {
            background-color: #fefefe; /* Цвет фона содержимого модального окна */
            margin: 15% auto; /* Отступ сверху и центрирование по горизонтали */
            padding: 20px; /* Отступ внутри модального окна */
            border: 1px solid #888; /* Рамка вокруг модального окна */
            width: 80%; /* Ширина модального окна */
        }
    </style>
</head>

<body>
    <div id="loadingScreen" class="loading-screen">
        <img src="https://example.com/loading-image.png" alt="Загрузка..."> <!-- Изображение во время загрузки -->
        <h2>Загрузка данных...</h2> <!-- Текст во время загрузки -->
    </div>

    <header>
        <img id="userAvatar" class="avatar" alt="Avatar" src="https://via.placeholder.com/80"> <!-- Аватар пользователя -->
        <div class="balance"> <!-- Блок с балансом -->
            <img src="https://img.icons8.com/ios-filled/50/ffffff/coin-dollar.png" class="coin-icon" alt="Coin"> <!-- Иконка монеты -->
            <span id="userBalance">0 ₽</span> <!-- Значение баланса -->
        </div>
    </header>

    <div id="usercard">Загрузка данных...</div> <!-- Блок для отображения данных пользователя -->

    <!-- Модальное окно профиля -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span> <!-- Кнопка закрытия модального окна -->
            <h2>Профиль пользователя</h2> <!-- Заголовок модального окна -->
            <div>
                <img src="" id="profileAvatar" alt="Avatar" style="width: 80px; height: 80px; border-radius: 50%;"> <!-- Аватар в модальном окне -->
            </div>
            <p><strong>Имя:</strong> <span id="profileName"></span></p> <!-- Имя пользователя -->
            <p><strong>Фамилия:</strong> <span id="profileLastName"></span></p> <!-- Фамилия пользователя -->

            <p><strong>Пользователь:</strong> <span id="profileUsername"></span></p> <!-- Имя пользователя в системе -->
        </div>
    </div>

    <!-- Нижние кнопки -->
    <div class="nav-buttons">
        <div class="nav-button" id="shopButton">Магазин</div> <!-- Кнопка "Магазин" -->
        <div class="nav-button" id="earnButton">Заработать</div> <!-- Кнопка "Заработать" -->
        <div class="nav-button" id="bonusButton">Бонусы</div> <!-- Кнопка "Бонусы" -->
        <div class="nav-button" id="moreButton">Другое</div> <!-- Кнопка "Другое" -->
    </div>

    <script>
        const tg = window.Telegram.WebApp; // Инициализация объекта Telegram Web App

        async function displayUserData(user) {
            // Функция для отображения данных пользователя на странице
            document.getElementById('userAvatar').src = user.avatar || 'https://via.placeholder.com/80'; // Установка аватара пользователя
            document.getElementById('userBalance').innerText = `${user.balance} ₽`; // Установка значения баланса
            document.getElementById('profileAvatar').src = user.avatar || 'https://via.placeholder.com/80'; // Установка аватара в модальном окне
            document.getElementById('profileName').innerText = user.firstName; // Установка имени в модальном окне
            document.getElementById('profileLastName').innerText = user.lastName || ''; // Установка фамилии в модальном окне
            document.getElementById('profileId').innerText = user.userId; // Установка ID в модальном окне
            document.getElementById('profileUsername').innerText = user.username || 'Не указан'; // Установка имени пользователя

            const userCard = document.getElementById('usercard'); // Получение элемента карточки пользователя
            userCard.innerHTML = `
                <img src="${user.avatar || 'https://via.placeholder.com/80'}" alt="Avatar"> <!-- Аватар в карточке пользователя -->
                <h3>${user.firstName} ${user.lastName || ''}</h3> <!-- Имя и фамилия в карточке -->
                <p><strong>Пользователь:</strong> ${user.username || 'Не указан'}</p> <!-- Имя пользователя -->
                <p><strong>Баланс:</strong> ${user.balance} ₽</p> <!-- Баланс пользователя -->
            `;
            userCard.style.display = 'block'; // Показать карточку пользователя
            document.getElementById('loadingScreen').style.display = 'none'; // Скрыть экран загрузки
        }

        async function getUserData() {
            // Функция для получения данных пользователя из Telegram
            const userId = tg.initDataUnsafe.user.id; // Получение ID пользователя
            const firstName = tg.initDataUnsafe.user.first_name; // Получение имени пользователя
            const lastName = tg.initDataUnsafe.user.last_name || ''; // Получение фамилии пользователя
            const username = tg.initDataUnsafe.user.username || ''; // Получение имени пользователя в системе
            const avatar = tg.initDataUnsafe.user.photo_url || 'https://via.placeholder.com/80'; // Получение URL аватара, установка по умолчанию

            const userData = {
                userId,
                firstName,
                lastName,
                username,
                avatar,
                balance: 1000 // Начальный баланс
            };

            await displayUserData(userData); // Вызов функции для отображения данных пользователя
        }

        document.addEventListener('DOMContentLoaded', getUserData); // Запуск функции получения данных пользователя после загрузки страницы

        // Обработка нажатия на кнопки
        document.getElementById('shopButton').onclick = function() {
            alert('Магазин открыт!'); // Простое уведомление при нажатии кнопки "Магазин"
        };
        document.getElementById('earnButton').onclick = function() {
            alert('Раздел заработка открыт!'); // Уведомление для кнопки "Заработать"
        };

            alert('Бонусы доступны!'); // Уведомление для кнопки "Бонусы"
        };
        document.getElementById('moreButton').onclick = function() {
            alert('Другие возможности открыты!'); // Уведомление для кнопки "Другое"
        };

        // Закрытие модального окна
        document.getElementById('closeModal').onclick = function() {
            document.getElementById('profileModal').style.display = 'none'; // Скрыть модальное окно при нажатии на кнопку закрытия
        };
    </script>
</body>
</html>
